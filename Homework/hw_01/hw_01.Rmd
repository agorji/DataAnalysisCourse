---
title: "first week: Introduction to R and Rstudio"
author: "Ali Gorji"
date: "`r Sys.time()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

<div align="center">
<img  src="images/Rman.jpeg"  align = 'center'>
</div>


<h1 dir="RTL"> 
تمرین سری اول: چند مساله
</h1>

<p dir="RTL"> 
به سوال های زیر را از طریق نوشتن یک کد پاسخ دهید.
</p>

***

<h2 dir="RTL">
ماتریس دوستانه
</h2>

<p dir="RTL">
یک ماتریس
$(n,n)$
که شامل اعداد 
$1,2,...,n^2$
است. دوستانه نامیده میشود اگر مجموع سطرها با مجموع ستون های آن برابر شوند. مثال هایی از ماتریس های دوستانه از بعد ۴و۵و۶ ارایه دهید. 
</p>

```{r}
library(abind)
library(magic)
magic(n = 4)
magic(n = 5)
magic(n = 6)
```

***

<h2 dir="RTL">
جایشگت  عجیب
</h2>

<p dir="RTL">
جایگشت هایی از اعداد ۱ تا ۱۳ را پیدا کنید که در شرایط زیر صدق کنند:
</p>

$$ a = (a_1, a_2,..., a_{13})$$
$$\frac{a_1}{a_2+a_3} = \frac{a_2+a_3}{a_3+a_4+a_5}<1$$
$$\frac{a_6}{a_6+a_7}= \frac{a_6+a_7}{a_7+a_8+a_9} = \frac{a_7+a_8+a_9}{a_5+a_9+a_{10}} <1$$

$$\frac{a_{11}+a_{12}}{a_{12}+a_{13}}=\frac{a_{12}+a_{13}}{a_{13}+a_{10}}<1$$

```{r}
library(gtools)
a <- permutations(13,5,1:13)
for(i in 1:(length(a)/5))
{
  if(a[i,1]/(a[i,2] + a[i,3]) == (a[i,2]+a[i,3])/(a[i,3]+a[i,4]+a[i,5]) &&
     a[i,1]/(a[i,2] + a[i,3])<1)
    {
      a6 <- permutations(8, 5,setdiff(1:13, a[i,]))
      for(j in 1:(length(a6)/5))
        {
          if(a6[j,1]/(a6[j,1] + a6[j,2]) <1 && 
             a6[j,1]/(a6[j,1] + a6[j,2])==(a6[j,1] + a6[j,2])/(a6[j,2] + a6[j,3] + a6[j,4]) && 
             a6[j,1]/(a6[j,1] + a6[j,2])==(a6[j,2] + a6[j,3] + a6[j,4])/(a[i,5] + a6[j,4] + a6[j,5]))
          {
            a11 <- permutations(3, 3, setdiff(1:13, c(a[i,], a6[j,])))
            for(k in 1:6)
              {
                if((a11[k,1] + a11[k,2])/(a11[k,2] + a11[k,3]) < 1 &&
                   (a11[k,1] + a11[k,2])/(a11[k,2] + a11[k,3]) == (a11[k,2] + a11[k,3])/(a11[k,3] + a6[j,5]))
                  {
                    print(c(a[i,], a6[j,], a11[k,]))
                }
            }
          }
        
        }
    }
}
```

***

<h2 dir="RTL">
مچ گیری
</h2>

<p dir="RTL">
میزگردی شامل ۱۶ فرد دروغگو و راستگو تشکیل شده است. هر کسی ادعا میکند دو فرد کنار دستی او دروغگو هستند. چند نفر دروغگو در جمع وجود دارد؟
</p>

اگر فرد دروغگو باشد، دو طرفش راستگو هستند. اگر راستگو باشد، دو طرفش دروغگو هستند. پس می توان گفت در این میزگرد یکی در میان راستگو و دروغگو نشسته انذ

```{r}
for(i in 0:(2**16-1)){
  num <- i
  a <- c()
  for(j in 16:1){
    a <- c(a,num%/%(2**j))
    num <- num%%(2**j)
  }
  flag <- F
  if(!(a[16] == a[2] && a[1]!=a[2]))
    next
  for(j in 2:16){
    if(!(a[(j-1)%%16] == a[j%%16+1] && a[j]!=a[j%%16+1])){
      flag <- T
      break
    }
  }
  if(!flag){
    print(sum(a))
    break
  }
}
```

<p dir="RTL">
میزگرد دیگری شامل ۱۲ نفر فرد راستگو و دروغگو تشکیل شده به طوری که هر فرد ادعا میکند از میان دو نفر کنار دستی یک نفر راستگو و یک نفر دروغگو هستند. چند نفر دروغگو در جمع وجود دارد؟
</p>

```{r}
for(i in 0:4095){
  num <- i
  a <- c()
  for(j in 12:1){
    a <- c(a,num%/%(2**j))
    num <- num%%(2**j)
  }
  flag <- F
  if(a[12] == a[2])
    next
  for(j in 2:12){
    if(a[(j-1)%%12] == a[j%%12+1]){
      flag <- T
      break
    }
  }
  if(!flag){
    print(sum(a))
    break
  }
}
```

<p dir="RTL">
این دفعه میزگردی هشت نفره تشکیل شده به گونه ایی که چهار نفر ادعا میکنند از از میان دو نفر کنار دستی یکی دروغگو و دیگری راستگوست و چهار نفر دیگر اعلام میکنند که هر دو فرد کنار دستی آنها دروغگو هستند. چند نفر دروغگو در میان جمع است؟
</p>

```{r}
for(i in 0:256){
  num <- i
  a <- c()
  for(j in 8:1){
    a <- c(a,num%/%(2**j))
    num <- num%%(2**j)
  }
  count1 <- 0
  count2 <- 0
  if(a[8] != a[2]){
    count1 <- count1+1
  }
  if(a[8] == a[2] && a[1] != a[2]){
    count2 <- count2+1
  }
  for(j in 2:8){
    if(a[(j-1)%%8] != a[j%%8+1]){
      count1 <- count1+1
    }
    if((a[(j-1)%%8] == a[j%%8+1]) && a[j] != a[j%%8+1]){
      count2 <- count2+1
    }
  }
  if(count1 == 4 && count2 == 4){
    print(sum(a))
    break
  }
}
```
