---
title: "Fifth Week: Bootstrap and Resampling Methods"
subtitle: "Nonparametric Hypothesis tests"
author: "Ali Gorji"
date: "`r Sys.time()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

<div align="center">
<img  src="images/NonparametricStatistics_iStock.jpg"  align = 'center'>
</div>

> <p dir="RTL"> 
لطفا با سوالات زیر پاسخ دهید.
در همه سوالات سطح دقت را ۹۵ درصد در نظر بگیرید.
</p>

***

<p dir="RTL">
۱. شرکتی میخواهد تحقیق کند آیا درآمد نمایندگی های آن یکسان است. برای بررسی این موضوع هشت نمایندگی
به طور تصادفی انتخاب شده اند که به ترتیب میزان فروش آنها عبارت است از 
102, 300, 102, 100, 205, 105, 71 , 92.
با توجه به داده آیا عملکرد نمایندگی ها یکسان است؟
<br>
از آن جایی که یک سمپل از یک جنس از یک فضا داریم و می خواهیم بررسی کنیم از یک توزیع پیروی می کند یا نه از Chi Square استفاده می کنیم. نتیجه به دست آمده نشان می دهد می توانیم فرض پیروی از یک توزیع را رد کنیم و بگوییم درآمد نمایندگی ها نمی تواند یکسان بوده و از توزیعی یکسانی پیروی کنند.
</p>

```{r}
library(readr)
library(coin)
data = c(102, 300, 102, 100, 205, 105, 71, 92)
chisq.test(data)
```

***

<p dir="RTL">
۲. آمار فروش شرکتی در دو نوع شعبه سنتی و مدرن در زیر آمده است:
</p>

Classical stores: 50, 50, 60, 70, 75, 80, 90, 85

Modern stores: 55, 75, 80, 90, 105, 65

<p dir="RTL">
آیا تفاوتی در عملکرد دو نوع شعبه وجود دارد؟
<br>
چون تعداد داده ها کم است از  permutation test استفاده می کنیم. نتیجه تست نشان می دهد نمی توانیم فرض یکسان بودن عملکرد دو شعبه را تایید کنیم، اما آن را رد هم نمی توانیم بکنیم. شاید اگر ابزارهای بهتری برای تست داشتیم می توانستیم فرض بهتری مطرح کنیم و به این سوال پاسخ دقیقی بدهیم.
</p>

```{r}
sellData = data.frame(sell = c(50,50, 60, 70, 75, 80, 90, 85, 55, 75, 80, 90, 105, 65),
                      type = factor(c(rep("C",8), rep("M", 6))))
oneway_test(sell~type, data = sellData)
```


***

<p dir="RTL">
۳. اطلاعات حسابداری ۱۵ شعبه که به صورت تصادفی انتخاب شده اند به شرح زیر است:
</p>

509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904

<p dir="RTL">
شرکت مذکور برای ارتقای فروش خود یک طرح تبلیغاتی جدید را اجرا میکند. پس از طرح جدید نتایج عملکرد شعبه ها  به صورت زیر 
اندازه گیری شده است
</p>

517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901

<p dir="RTL">
آیا تبلیغات جدید عملکرد فروش را بالا برده است؟
<br>
با توجه به اینکه به نظر می رسد اعداد به صورت مرتب شده باشند، ما با ۱۵ جفت عدد برای مقادیر عملکرد قبل و بعد اجرای طرح طرفیم. به همین دلیل ترجیح می دهیم از Wilcoxon استفاده کنیم تا یکسان بودن توزیع را در هر دو دسته بررسی کنیم. از آن جایی که پی ولیو مقدار نسبتا بالایی به دست آمد نمی توانیم فرض یکسان نبودن را رد کنیم. همینطور نمی توانیم با این تست صراحتا اعلام کنیم طرح بی تاثیر بوده ولی می توانیم بگوییم احتمال تاثیر مثبت داشتن این طرح بر کارایی کمتر از بی تاثیری آن بوده است!
</p>
```{r}
wilcox.test(c(509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904),c(517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901), alt = "greater")
```
***

<p dir="RTL">
۴. محصولی در سه رنگ سفید آبی و قرمز تولید شده است.
پنج شعبه ار فروشگاه سازنده محصول به صورت تصادفی انتخاب شده و اطلاعات فروش آنها در زیر آمده است.
</p>

| Store | White | Blue | Red |
| :----: | :----: | :----: | :----: |
| 1. |	510 |	925 |	730 |
| 2. | 720 | 735 | 745 |
| 3. |	930 |	753 |	875 |
| 4. |	754 |	685 |	610 |
| 5. |	105	|  |  |

<p dir="RTL">
با توجه به داده های بالا آیا رنگی خاص در میزان فروش محصولات تاثیر دارد؟
<br>
سه دسته که از توزیعشان مطلع نیستیم داریم و می خواهیم ببینیم آیا این سه توزیع یکسانی دارند یا خیر. برای این کار از تست Kruskal استفاده می کنیم. نتیجه نشان می دهد پی ولیو بالاست. نمی توانیم فرض یکسان بودن را رد بکنیم و به این نتیجه برسیک که رنگ در میزان فروش تاثیر داردو اما می توان گفت به احتمال بالایی میزان فروش مستقل از رنگ محصولات است.
</p>

```{r}
coloredData = data.frame(sell = c(510,720,930,754,105,925,735,753,685,730,745,875,610),
                      color = factor(c(rep("W",5), rep("B", 4), rep("R", 4))))
kruskal.test(sell~color, data = coloredData)
```

***

<p dir="RTL">
۵. یک موسسه نظرسنجی نظرات مردم در مورد رضایت از یک محصول که در ماه های فروردین اردیبهشت خرداد و تیر که از طریق تلویزیون 
تبلیغ شده است را مورد ارزیابی قرار می دهد.این کار بدین صورت است از افرادی در ماه اول سوال پرسیده می شود و در ماه آینده نیز از همان فرد سوال می شود که آیا از محصول مذکور راضی هستی یا خیر.
با توجه به داده ایی که در پیوست تمرین آمده است آیا تبلیغات تاثیر مثبتی در افزایش رضایت مردم داشته است؟
</p>

<p dir="RTL">
از آن جایی که مقدار یک متغیر تصادفی (میزان رضایت از محصول) در زمان های مختلف بررسی شده و می خواهیم مقایسه ای روی آن انجام دهیم به نظر می رسد تست friedman تست مناسبی باشد.
<br>
این تست با این فرض انجام می شود که بررسی کند آیا ستون های مختلف توزیع یکسانی دارند یا خی. از آن جایی که پی ولیو به دست آمده عدد بالایی است، در عین حال که نمی توانیم با قطعیت خواسته شده فرض یکسان بودن توزیع رضایت در ماه های مختلف را رد کنیم، ولی تا حد خوبی می توان گفت فرض تاثیر تبلیغات می تواند رد شود.
</p>

```{r}
tv <- read.csv("data/tv.csv")
friedman.test(as.matrix(tv))

wilcox.test(tv$March, tv$April)
wilcox.test(tv$April, tv$May)
wilcox.test(tv$April, tv$Jun)
```
<p dir="RTL">
برای بررسی های بیشتر با کمک تست Wilcoxon ماه های متوالی را با هم مقایسه می کنیم. نتایج به دست آمده نشان می دهد سه ماه اول توزیع یکسانی دارند و برای ماه جون به نسبت ماه می نمی توان دقیق اظهار نظر کرد ولی با این تست نمی توانیم هم فرض یکسان بودن توزیع را رد کنیم.
</p>
```{r}
wilcox.test(tv$March, tv$April)
wilcox.test(tv$April, tv$May)
wilcox.test(tv$April, tv$Jun)
```
***

<p dir="RTL"> 
۶. شرکتی در حال تحقیق بر روی این موضوع است که آیا جمعیت شهر تاثیری در نوع میزان مصرف محصولات شرکت دارد.
با توجه به داده زیر این موضوع را تحقیق کنید؟
</p>

| City size |	| Frequency of service usage | |
| :---: |  :---:  | :---: | :---: | 
| | Always	| Sometime | Never |
| Small	| 151	| 252	| 603 |
| Medium	| 802	| 603	| 405 |
| Large	| 753	| 55	| 408 |

<p dir="RTL"> 
می خواهیم استقلال دو متغیر را بررسی کنیم؛ جمعت یک شهر و میزان مصرف محصولات، که هر دوی اینها کتگوریال هستند. پس از Chi Square برای این منظور استفاده می کنیم. پی ولیو پایین به دست آمده از این تست نشان می دهد می توانیم با قطعیت بگوییم جمعیت شهر در میزان مصرف محصولات شرکت در یک شهر دارد.
</p>

```{r}
populationedData = data.frame(always = c(151, 802, 753), sometimes = c(252, 603, 55), never = c(603, 405, 408), row.names = c("small", "medium", "large"))
chisq.test(populationedData)
```

***

<p dir="RTL"> 
۷. شرکتی انتظار دارد با ارایه محصول الف میزان فروش محصول ب افزایش یابد.
به همین منظور به طور تصادفی از صد مشتری خود اطلاعات مصرف جمع آوری می نماید.
با توجه به داده های که داده شده آیا ربط معناداری بین فروش این دو محصول وجود دارد؟
</p>

<p dir="RTL"> 
جفت هایی از اعداد داریم (میزان فروش محصول الف و ب) که می خواهیم ارتباط آن ها را بررسی کنیم. به همین منظور از تست Wilcoxon استفاده می کنیم. این تست بررسی می کند این اعداد که در دو دسته قرار می گیرند از یک توزیع پیروی می کنند یا خیر. پی ولیو پایین به دست آمده نشان می دهد می توانیم فرض مستقل بودن میزان فروش این دو محصول را رد کنیم و بگوییم بین فروش این دو محصول ربط معناداری وجود دارد.
</p>


```{r}
consumption <- read.csv("data/consumption.csv")
wilcox.test(consumption$A, consumption$B)
```

***

<p dir="RTL"> 
۸. یک شرکت از ۲۰۰۰ نفر از مشتریان خود عامل خرید محصول را مورد سوال قرار میدهد 
که خلاصه اطلاعات آن را در زیر می توانید مشاهده کنید
</p>

| Characteristics	| Male	| Female |
| :---: |  :---:  | :---: |
| Price	| 301	| 502 |
| Design	| 353	| 155 |
| Color	| 558	| 153 |

<p dir="RTL"> 
آیا جنسیت تاثیری در مشخصه کاربری کالا دارد؟
</p>

<p dir="RTL"> 
برای مشخص شدن این مطلب از تست Chi-Square استفاده می کنیم تا بررسی کنیم آیا مشخصه های کاربری مختلف بی تاثیر از جنسیت هستند یا خیر. با توجه به زیر 0.05 بودن پی ولیو به دست آمده از این تست می توانیم صراحتا بگوییم جنسیت در مشخصه های کاربری مهم نقش بزرگی دارد.
</p>

```{r}
sexedData = data.frame(always = c(301, 353, 558), sometimes = c(502, 155, 153), row.names = c("price", "design", "color"))
chisq.test(sexedData)
```


